@model IEnumerable<BudgetApplication.Models.ViewModels.ItemTableViewModel>
@{
    ViewData["Title"] = "ChartView";
}

<!DOCTYPE HTML>
<html>
<head>

    <link rel="stylesheet" href="css/site.css" />

    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    
    
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" />
    <script src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" type="text/javascript"></script>

    <script>

        $(document).ready(function () {
            $('#myTable').DataTable();
        });

        window.onload = function() {

            var chart = new CanvasJS.Chart("chartContainer",
                {
                    theme: "light1", // "light1", "light2", "dark1", "dark2"
                    exportEnabled: true,
                    animationEnabled: true,
                    title: {
                        text: "Budget Pie Chart"
                    },
                    subtitles: [
                        {
                            text: "Q2, 2016"
                        }
                    ],
                    data: [
                        {
                            type: "pie",
                            startAngle: 180,
                            toolTipContent: "<b>{label}</b>: {y}%",
                            showInLegend: "true",
                            legendText: "{label}",
                            indexLabel: "{label} - {y}%",
                            dataPoints: @Html.Raw(ViewBag.DataPoints)
                        }
                    ]
                });
            chart.render();


        }
    </script>
</head>
<body>
    <div id="chartContainer"></div>
    <br />
    <br />

    <table id="myTable" class="ui celled table">
        <thead>
            <tr>
                <th>Item Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>Purchased Date</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td data-label="item-name">@item.ItemName</td>
                    <td data-label="category-name">@item.CategoryName</td>
                    <td data-label="price">$@item.Price</td>
                    <td data-label="purchased-date">@item.PurchasedDate</td>
                </tr>
            }
    </table>

    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#add-item">
        Add New Item
    </button>

    <!-- Modal -->
    <div class="modal fade" id="add-item" tabindex="-1" role="dialog" aria-labelledby="add-itemlabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            @using (Html.BeginForm("AddItem", "Item", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="new-item-label">New Item</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">

                        <div class="form-group">
                            <label for="name">Name</label>
                            @Html.TextBox("Name", "", new { @class = "form-control", @placeholder = "Enter Item Name" })
                        </div>

                        <div class="form-group">
                            <label for="price">Price</label>
                            @Html.TextBox("Price", "", new { @class = "form-control", @placeholder = "Enter Price", @type = "number", @step = ".01" })
                        </div>

                        <div class="form-group">
                            <label for="category">Category</label>
                            @Html.DropDownList("Category", null, htmlAttributes: new { @class = "form-control" })
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Add Item</button>
                    </div>
                </div>
            }
        </div>

    </div>
</body>
</html>

